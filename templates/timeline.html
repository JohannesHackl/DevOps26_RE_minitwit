{{ define "timeline.html" }}
{{ template "header" . }}
  <h2>{{ .title }}</h2>
  {{ if .user }}
    {{ if eq .endpoint "user_timeline" }}
      <div class="followstatus">
      {{ if eq .user.UserID .profile_user.UserID }}
        This is you!
      {{ else if .followed }}
        You are currently following this user.
        <a class="unfollow" href="/u/{{ .profile_user.Username }}/unfollow">Unfollow user</a>.
      {{ else }}
        You are not yet following this user.
        <a class="follow" href="/u/{{ .profile_user.Username }}/follow">Follow user</a>.
      {{ end }}
      </div>
    {{ else if eq .endpoint "timeline" }}
      <div class="twitbox">
        <h3>What's on your mind {{ .user.Username }}?</h3>
        <form action="/add_message" method="post">
          <p><input type="text" name="text" size="60"><!--
          --><input type="submit" value="Share">
        </form>
      </div>
    {{ end }}
  {{ end }}
  <ul class="messages">
  {{ if .messages }}
    {{ range .messages }}
    <li><img src="{{ gravatar .Email }}"><p>
      <strong><a href="/u/{{ .Username }}">{{ .Username }}</a></strong>
      {{ .Text }}
      <small>&mdash; {{ datetimeformat .PubDate }}</small>
    </li>
    {{ end }}
  {{ else }}
    <li><em>There's no message so far.</em></li>
  {{ end }}
  </ul>
{{ template "footer" . }}
{{ end }}
